# AppGenius複数AIエージェント開発方法論 2.0

## 概要

本ドキュメントでは、複数AIによる効率的な開発プロセスとシステムの全体像について解説します。このアプローチは、要件定義から実装、テスト、デプロイまでの一連の流れを体系化し、モックアップ主導の開発と複数AIの連携による高品質なソフトウェア開発を実現します。

## エージェント構成

AppGeniusでは、18の専門AIエージェントが連携して開発を進めます。各エージェントは特定の役割と責任を持ち、一貫した成果物を生成します。

### 1. コア設計エージェント群

#### 1. プロジェクトファウンデーション
- **役割**: 要件定義、技術選定、基本アーキテクチャの設計
- **成果物**: requirements.md, architecture/tech-stack.md, 初期 directory-structure.md
- **参照**: クライアント要望資料、業界標準、競合分析
- **特徴**: プロジェクトの基盤となる設計を担当、方向性を決定
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/cdc2b284c05ebaae2bc9eb1f3047aa39

#### 2. モックアップクリエイター
- **役割**: UI/UX設計、HTMLモックアップ作成
- **成果物**: mockups/ ディレクトリ内の全ファイル
- **参照**: requirements.md, tech-stack.md, UI/UXガイドライン
- **特徴**: ビジュアル面に集中、ユーザー体験を具体化
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/8cdfe9875a5ab58ea5cdef0ba52ed8eb

#### 3. データモデルアーキテクト
- **役割**: データ構造設計、エンティティ関係定義、型システム設計
- **成果物**: shared/index.ts
- **参照**: requirements.md, mockups/, tech-stack.md
- **特徴**: モックアップからデータ要件を抽出して型定義化、フロントエンド/バックエンド間の型共有を設計
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/f0f6805b80ae32f3846c35fe9df4eefe

#### 4. APIデザイナー
- **役割**: REST API設計、エンドポイント定義
- **成果物**: docs/api/ ディレクトリ内の全ファイル
- **参照**: shared/index.ts, mockups/, requirements.md
- **特徴**: フロントとバックエンドの接続ポイントを設計

#### 5. 要件定義統合エージェント
- **役割**: モックアップから抽出された要件の統合、実装計画への橋渡し
- **成果物**: 更新された requirements.md, 最終化された directory-structure.md, 実装優先順位計画
- **参照**: モックアップ一式, データモデル, API仕様, 初期要件定義
- **特徴**: モックアップ作成段階で発見された要件を統合し、実装フェーズの基盤を準備

### 2. 基盤構築エージェント群

#### 6. 環境変数収集エージェント
- **役割**: 本番環境接続用の環境変数収集と管理
- **成果物**: .env, docs/deployment/env-template.md
- **参照**: tech-stack.md, 既存APIキーと認証情報
- **特徴**: 実際の本番環境キーを安全に収集・管理
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/50eb4d1e924c9139ef685c2f39766589

#### 7. 認証システムエージェント
- **役割**: JWT認証システムの設計と実装
- **成果物**: 認証関連コードとドキュメント
- **参照**: tech-stack.md, API仕様書, データモデル
- **特徴**: セキュアで自社実装のJWTベース認証システム
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/44b995b91e9879080c4e0169e7a51c0e

### 3. 実装エージェント群

#### 8. スコーププランナー
- **役割**: タスク分解、依存関係分析、実装計画
- **成果物**: SCOPE_PROGRESS.md
- **参照**: requirements.md, mockups/, shared/index.ts, api/, tech-stack.md
- **特徴**: 開発ロードマップを作成、具体的なタスクに落とし込む
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/b168dcd63cc12e15c2e57bce02caf704

#### 9. フロントエンド実装エージェント
- **役割**: UI実装、状態管理、APIクライアント
- **成果物**: フロントエンドコード
- **参照**: mockups/, api/, shared/index.ts, SCOPE_PROGRESS.md, tech-stack.md
- **特徴**: モックアップを動作するコードに変換
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/868ba99fc6e40d643a02e0e02c5e980a

#### 10. バックエンド実装エージェント
- **役割**: API実装、データアクセス、ビジネスロジック
- **成果物**: バックエンドコード
- **参照**: shared/index.ts, api/, SCOPE_PROGRESS.md, tech-stack.md
- **特徴**: 型定義と仕様からサーバー側を実装

### 4. 品質管理エージェント群

#### 11. テスト管理エージェント
- **役割**: テスト戦略、DB-TDD、品質保証
- **成果物**: testing/test-strategy.md, テストコード
- **参照**: requirements.md, api/, 実装コード
- **特徴**: データベース直接検証による効率的で信頼性の高いテスト
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/247df2890160a2fa8f6cc0f895413aed

#### 12. デバッグ探偵
- **役割**: フロントエンドエラーとAPI連携問題の分析・解決
- **成果物**: バグ修正、問題分析レポート
- **参照**: フロントエンドコード、API定義、ログ
- **特徴**: 根本原因分析と最小変更での問題解決
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/942ec5f5b316b3fb11e2fd2b597bfb09

### 5. デプロイと管理エージェント群

#### 13. デプロイ設定エージェント
- **役割**: Google Cloud Run環境へのデプロイ支援
- **成果物**: docs/deployment/deploy.md, デプロイスクリプト
- **参照**: tech-stack.md, 実装コード
- **特徴**: 環境差異の解消と安定したデプロイプロセスの確立
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/612fc1991ca477744c4544255d40fe0b

#### 14. GitHub管理エージェント
- **役割**: コード管理、安全なアップロード
- **成果物**: .gitignore, ブランチ戦略, コミット管理
- **参照**: プロジェクトファイル, .env
- **特徴**: 作業保全とセンシティブ情報の保護を最優先
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/e6167ac13d15f778c0cae369b0068813

### 6. 特殊目的エージェント群

#### 15. プロジェクト分析エージェント
- **役割**: 既存コード分析、リバースエンジニアリング
- **成果物**: 既存プロジェクト分析ドキュメント
- **参照**: 既存コードベース全体, 依存関係ファイル
- **特徴**: 途中参加時に既存システムを解析、現状把握を支援

#### 16. リファクタリングスペシャリスト
- **役割**: コード最適化、技術的負債対策
- **成果物**: リファクタリング計画と実装
- **参照**: 既存コード, パフォーマンス指標, コードレビュー
- **特徴**: 既存コードの品質向上、保守性の改善
- **URL**: http://appgenius-portal-test-235426778039.asia-northeast1.run.app/api/prompts/public/af9d922c29beffe1224ac6236d083946

#### 17. 段階的コード分割リファクタリングアドバイザー
- **役割**: 大規模コードファイルの安全な分割
- **成果物**: 詳細なリファクタリングタスクリスト、実装計画
- **参照**: リファクタリング対象コード
- **特徴**: 「骨を残して肉を入れ替える」アプローチによる安全なコード分割

#### 18. チェンジディレクター
- **役割**: 追加要件の分析、変更管理、AIエージェント間の調整
- **成果物**: 変更影響分析、更新プラン
- **参照**: requirements.md, SCOPE_PROGRESS.md, 全ドキュメント, 変更要求
- **特徴**: 既存プロジェクトへの機能追加やスコープ変更を管理

## ドキュメント構造

AppGeniusプロジェクトでは、以下のような構造でドキュメントを管理します：

```
project/
├── docs/                           # ドキュメントのルートディレクトリ
│   ├── requirements.md             # プロジェクト全体の要件定義書
│   ├── SCOPE_PROGRESS.md           # スコープ進捗状況とタスクリスト（中心的文書）
│   ├── architecture/               # アーキテクチャ関連ドキュメント
│   │   ├── directory-structure.md  # 理想的ディレクトリ構造の定義
│   │   └── tech-stack.md           # 技術スタックと選定理由
│   │
│   ├── api/                        # API仕様書
│   │   ├── index.md                # API概要と共通規則
│   │   ├── auth.md                 # 認証関連API
│   │   ├── users.md                # ユーザー管理API
│   │   └── [機能カテゴリ].md        # 機能別APIドキュメント
│   │
│   ├── deployment/                 # デプロイ関連
│   │   ├── env-template.md         # 環境変数テンプレート（実際の値は除外）
│   │   └── deploy.md               # デプロイ手順と環境設定
│   │
│   └── testing/                    # テスト関連（必要に応じて）
│       └── test-strategy.md        # テスト戦略とアプローチ
│
├── mockups/                        # モックアップのルートディレクトリ
│   ├── index.html                  # モックアップ一覧・ナビゲーション
│   ├── components/                 # 共通コンポーネント
│   │   └── [component-name].html   # 再利用可能なコンポーネント
│   │
│   └── pages/                      # ページ別モックアップ
│       ├── [page-name].html        # 各ページのモックアップ
│       └── assets/                 # モックアップで使用する画像等
│
├── shared/                         # 共有ファイルディレクトリ
│   └── index.ts                    # 型定義の単一の真実源
│
└── .env.example                    # 環境変数の例（実際の値は除外）
```

### ドキュメント構造の特徴

1. **シンプルな階層構造**:
   - 最大3階層に制限し、ナビゲーションを容易に
   - 関連文書を論理的にグループ化

2. **中心文書の明確化**:
   - requirements.mdとSCOPE_PROGRESS.mdをトップレベルに配置
   - 最も頻繁に参照される文書へのアクセスを簡単に

3. **機能別の文書分割**:
   - APIドキュメントを機能カテゴリ別に分割
   - 大きすぎる単一文書を避け、特定情報へのアクセスを容易に

4. **モックアップの独立管理**:
   - mockups/ディレクトリを別途設け、視覚的資料を整理
   - ページとコンポーネントの明確な分離

5. **実装との連携**:
   - 実際のソースコードディレクトリ構造と対応するドキュメント構造
   - shared/index.tsを通じたドキュメントとコード間の一貫性確保
   - 型定義を通じたフロントエンド/バックエンド間の整合性担保

## 開発プロセス

### 開発フロー

AppGeniusでは、以下のフローで開発を進めます：

#### 1. 初期計画フェーズ

1. **requirements.md**
   - プロジェクトの基本要件とゴールを定義
   - ページ一覧と主要機能の概要を作成
   - ユーザーストーリーと優先順位の設定

2. **architecture/tech-stack.md**
   - プロジェクトの技術選定と根拠を文書化
   - フロントエンド/バックエンド技術の決定
   - 開発環境と依存関係の定義

3. **architecture/directory-structure.md** (初期版)
   - 基本的なプロジェクト構造を設計
   - 命名規則とファイル配置ルールの確立
   - 拡張性を考慮した構造設計

4. **.env.example** (初期版)
   - 必要な環境変数の種類を定義
   - 各変数の目的と形式を説明
   - 秘匿情報の管理方針を確立

#### 2. モックアップ開発フェーズ

5. **mockups/components/** (基本コンポーネント)
   - 共通UI要素の設計と実装
   - デザインシステムの基礎確立
   - 再利用パターンの定義

6. **mockups/pages/** (優先度順)
   - コア機能から順にページモックアップを作成
   - ユーザーフローを実現する画面遷移の実装
   - インタラクションとフォーム要素の動作確認

7. **mockups/index.html**
   - 全モックアップへのナビゲーション実装
   - モックアップの全体像を可視化
   - 進捗状況の確認ポイント提供

#### 3. 技術設計フェーズ

8. **shared/index.ts**
   - モックアップから必要なデータ構造を抽出して型定義化
   - エンティティ間の関係を型システムで定義
   - フロントエンド/バックエンドで共有する型の設計

9. **directory-structure.md** (更新版)
   - モックアップから明らかになった実際のコンポーネント構造を反映
   - バックエンドの役割と責任に基づく構造の最適化
   - コード生成と保守を考慮したフォルダ構成の微調整

10. **api/index.md**
   - API設計の基本原則を定義
   - エンドポイント命名規則の確立
   - 認証とエラーハンドリングの共通方針

11. **api/[機能カテゴリ].md** (優先度順)
    - モックアップの機能を実現するAPI設計
    - リクエスト/レスポンス形式の定義
    - エラーケースの考慮

12. **api/auth.md**
    - 認証フローの詳細設計
    - トークン管理とセキュリティ対策
    - 権限管理の仕組み

13. **testing/test-strategy.md**
    - テストアプローチと範囲の定義
    - ユニット/統合/E2Eテストの方針
    - テスト環境と自動化の計画

#### 4. 実装準備フェーズ

14. **SCOPE_PROGRESS.md** (初期版)
    - 第一実装スコープの詳細定義
    - 具体的なタスクリストの作成
    - 依存関係と優先順位の設定
    - 要件定義統合エージェントの分析に基づく実装計画

15. **deployment/deploy.md**
    - 開発環境から本番環境への移行手順
    - CI/CDパイプラインの設定方法
    - リリース手順とチェックリスト

16. **deployment/env-template.md** (詳細版)
    - 実装に必要な全環境変数の完全リスト
    - 各環境(開発/ステージング/本番)の設定差分
    - シークレット管理の詳細手順

#### 5. 実装・改善サイクル

17. **SCOPE_PROGRESS.md** (継続的更新)
    - 実装進捗に合わせた定期的な更新
    - 次のスコープの詳細計画追加
    - 完了タスクの記録と振り返り

18. **architecture/directory-structure.md** (最終版)
    - 実際の実装経験を反映した調整
    - コード分割や最適化の反映
    - 将来の拡張性考慮点の追加

19. **requirements.md** (最終更新)
    - 実装過程で明らかになった要件の調整
    - 実現した機能と制約の明確化
    - プロジェクト全体の完成状況確認

### エージェント間のファイル参照フロー

- **初期設計フロー**:  
  クライアント要望 → プロジェクトファウンデーション → モックアップクリエイター → データモデルアーキテクト → APIデザイナー → 要件定義統合エージェント

- **実装フロー**:  
  要件定義統合エージェント → スコーププランナー → フロントエンド/バックエンド実装エージェント → テスト&品質エージェント

- **デプロイフロー**:  
  実装コード + 技術スタック情報 → 環境&デプロイエージェント → 本番環境

- **メンテナンスフロー**:  
  変更要求 → チェンジディレクター → 関連エージェント → リファクタリングスペシャリスト

## 特殊ケース対応

### 既存プロジェクト分析

既存プロジェクトに途中から参加する場合、プロジェクト分析エージェントを使用して以下のステップで分析を行います：

#### ステップ1: 基本構造の把握
- プロジェクトのディレクトリ構造の分析
- 主要ファイルとエントリーポイントの特定
- 依存関係の把握（package.jsonなど）

#### ステップ2: 技術スタックの特定
- 使用されているフレームワークとライブラリの確認
- ビルドツールと開発環境の理解
- アーキテクチャパターンの特定

#### ステップ3: 型定義の分析
- shared/index.tsのような型定義ファイルを重点的に調査
- データモデルとAPI型の構造を理解
- フロントエンドとバックエンド間の型共有パターンを把握

#### ステップ4: コンポーネント構造の分析
- 主要UIコンポーネントの特定
- ビジネスロジックの分離パターンの理解
- 状態管理アプローチの把握

#### ステップ5: APIとデータフローの分析
- エンドポイント設計とRESTfulパターンの理解
- データの流れと加工ポイントの特定
- 認証メカニズムの分析

#### ステップ6: レポート生成
- 既存ドキュメントの再構成
- 不足しているドキュメントの特定と作成
- 分析結果のSCOPE_PROGRESSへの統合

### 追加要件と変更管理

追加要件が発生した場合、チェンジディレクターが変更の種類と影響範囲を分析し、適切なプロセスを選択します：

1. **小規模な変更**（既存機能の微調整、単一エンドポイントの追加など）:
   - CURRENT_STATUS.mdとimplementation_order.md更新
   - スコーププランナーへの引き継ぎ

2. **中規模の変更**（既存機能の拡張、複数画面の変更など）:
   - 簡易版の要件定義追加
   - モックアップクリエイターへの引き継ぎ

3. **大規模な変更**（新しい機能領域、コアシステムへの影響大）:
   - 要件定義書の更新
   - 初めからの開発サイクル適用
   
4. **機能削除/廃止**:
   - リファクタリングスペシャリストによる影響分析
   - 段階的な削除計画作成

### コード最適化とリファクタリング

リファクタリングが必要な場合、以下のアプローチを取ります：

1. **全体的なアーキテクチャ改善**:
   - リファクタリングスペシャリストが技術的負債を分析
   - 改善計画の作成と優先順位付け
   - スコープ分けと段階的な実装
   
2. **大規模ファイルの分割**:
   - 段階的コード分割リファクタリングアドバイザーによる詳細分析
   - 関数一覧と依存関係マップの作成
   - フェーズ分けされた実装タスクリストの作成
   - 並行動作による安全性確保

## 型定義の参照パターン

型定義を「単一の真実源」として効果的に活用するためのベストプラクティス：

1. **API仕様書での型定義参照**
```markdown
## POST /api/users
**リクエスト型**: [CreateUserRequest](/shared/index.ts#L120-L135)
**レスポンス型**: [ApiResponse<User>](/shared/index.ts#L220-L225)

このエンドポイントは新規ユーザーを作成します。パスワードは自動的にハッシュ化されます。
```

2. **データモデル文書での型定義参照**
```markdown
### ユーザーエンティティ

ユーザーモデルは認証と権限管理の基盤となる重要なエンティティです。
**モデル定義**: [User型](/shared/index.ts#L50-L70)
**関連モデル**: 
- [UserRole型](/shared/index.ts#L30-L35) - ユーザーの役割と権限レベル
- [UserPreferences型](/shared/index.ts#L80-L95) - ユーザー設定情報
```

3. **実装タスクでの型定義参照**
```markdown
### FE-2: ユーザー管理画面の実装
- 目標: 2025-05-10
- 依存: BE-1
- 型定義: 
  - [UserListResponse](/shared/index.ts#L250-L260)
  - [UserSortOptions](/shared/index.ts#L180-L185)
```

4. **実装コード内の型定義参照コメント**
```typescript
/**
 * ユーザーサービス実装
 * @see /shared/index.ts#L50-L70 - User型定義
 */
class UserService {
  // 実装
}
```

5. **モックアップからデータモデルへの参照**
```html
<!-- ユーザープロフィールカード -->
<!-- データモデル: /shared/index.ts#L50-L70 (User型) -->
<div class="user-card">
  <h3 class="user-name">{{user.displayName}}</h3>
  <p class="user-role">{{user.role}}</p>
</div>
```

## 開発原則

1. **モックアップ主導開発**
   - モックアップをまず作成し、それを「動かす」ことに集中
   - 非技術者にも理解しやすい進捗状況の可視化

2. **単一の真実源**
   - 型定義はshared/index.tsに一元管理
   - APIパスもshared/index.tsで定義

3. **中央資料の一貫性維持**
   - すべての変更は中央資料に反映
   - 複数AIが同じ情報源を参照できるよう整合性を保持

4. **シンプルさと品質重視の姿勢**
   - 「とりあえず動く」ではなく、正しく簡潔な実装を追求
   - 本質的に必要なものだけを残し、複雑性を排除
   - 問題の根本原因を特定し、正面から解決

5. **実証的アプローチ**
   - モックデータではなく実際の環境変数を使用
   - テスト環境でも本番環境と同じ認証情報を使用

6. **シンプルな自社実装認証**
   - JWTベースの独自認証システム実装
   - データフローのシンプル化とエラー特定の容易さを実現
   - アクセストークンとリフレッシュトークンの2段階方式

7. **機能のライフサイクル管理**
   - 機能の提案から実装、保守、廃止までを体系的に管理
   - 変更・追加・削除の影響範囲を常に評価
   - リファクタリングを継続的改善サイクルに組み込む

## まとめ

AppGeniusの複数AIエージェント開発方法論は、要件定義からモックアップ作成、データモデル設計、実装、テスト、デプロイまでの一連のプロセスを体系化し、17の専門AIエージェントの連携によって高品質なソフトウェア開発を実現します。

この方法論の特徴は、役割が明確に分担されたAIエージェント、シンプルで整理されたドキュメント構造、型定義の一元管理、モックアップ主導の開発プロセス、そしてSCOPE_PROGRESSによる進捗管理です。

各AIエージェントがその専門分野に集中し、一貫したドキュメントと成果物を生成することで、シンプルで堅牢、かつ保守性の高い開発を実現します。また、既存プロジェクト分析や変更管理、リファクタリングなどの特殊ケースにも対応するエージェントを用意し、プロジェクトのライフサイクル全体をサポートします。